inf2_1b7f=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/1b7f/assemble/top3000fragchains.fragments-inf2")
inf2_1cvj=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/1cvj/assemble/top3000fragchains.fragments-inf2")
inf2_2mgz=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/2mgz/assemble/top3000fragchains.fragments-inf2")
inf2_2yh1=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/2yh1/assemble/top3000fragchains.fragments-inf2")
inf2_3nnh=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/3nnh/assemble/top3000fragchains.fragments-inf2")
inf2_4bs2=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/4bs2/assemble/top3000fragchains.fragments-inf2")
inf2_u1b7f=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/unbound-1b7f/assemble/top3000fragchains.fragments-inf2")
inf2_u2yh1=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/unbound-2yh1/assemble/top3000fragchains.fragments-inf2")

inf3_1b7f=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/1b7f/assemble/top3000fragchains.fragments-inf3")
inf3_1cvj=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/1cvj/assemble/top3000fragchains.fragments-inf3")
inf3_2mgz=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/2mgz/assemble/top3000fragchains.fragments-inf3")
inf3_2yh1=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/2yh1/assemble/top3000fragchains.fragments-inf3")
inf3_3nnh=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/3nnh/assemble/top3000fragchains.fragments-inf3")
inf3_4bs2=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/4bs2/assemble/top3000fragchains.fragments-inf3")
inf3_u1b7f=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/unbound-1b7f/assemble/top3000fragchains.fragments-inf3")
inf3_u2yh1=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/unbound-2yh1/assemble/top3000fragchains.fragments-inf3")

inf5_1b7f=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/1b7f/assemble/top3000fragchains.fragments-inf5")
inf5_1cvj=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/1cvj/assemble/top3000fragchains.fragments-inf5")
inf5_2mgz=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/2mgz/assemble/top3000fragchains.fragments-inf5")
inf5_2yh1=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/2yh1/assemble/top3000fragchains.fragments-inf5")
inf5_3nnh=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/3nnh/assemble/top3000fragchains.fragments-inf5")
inf5_4bs2=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/4bs2/assemble/top3000fragchains.fragments-inf5")
inf5_u1b7f=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/unbound-1b7f/assemble/top3000fragchains.fragments-inf5")
inf5_u2yh1=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/unbound-2yh1/assemble/top3000fragchains.fragments-inf5")

Nb_1b7f=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/1b7f/assemble/top3000fragchains-Nfrags")
Nb_1cvj=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/1cvj/assemble/top3000fragchains-Nfrags")
Nb_2mgz=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/2mgz/assemble/top3000fragchains-Nfrags")
Nb_2yh1=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/2yh1/assemble/top3000fragchains-Nfrags")
Nb_3nnh=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/3nnh/assemble/top3000fragchains-Nfrags")
Nb_4bs2=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/4bs2/assemble/top3000fragchains-Nfrags")
Nb_u1b7f=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/unbound-1b7f/assemble/top3000fragchains-Nfrags")
Nb_u2yh1=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/unbound-2yh1/assemble/top3000fragchains-Nfrags")

min_1b7f=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/1b7f/assemble/top3000fragchains.minRMSD")
min_1cvj=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/1cvj/assemble/top3000fragchains.minRMSD")
min_2mgz=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/2mgz/assemble/top3000fragchains.minRMSD")
min_2yh1=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/2yh1/assemble/top3000fragchains.minRMSD")
min_3nnh=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/3nnh/assemble/top3000fragchains.minRMSD")
min_4bs2=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/4bs2/assemble/top3000fragchains.minRMSD")
min_u1b7f=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/unbound-1b7f/assemble/top3000fragchains.minRMSD")
min_u2yh1=scan(file = "~/rex/Projects/ssRNA/RRM-benchmark5/unbound-2yh1/assemble/top3000fragchains.minRMSD")

col_1b7f=c("orange","orange","green","cyan","blue","cyan","green")
col_1cvj=c("orange","orange","red","yellow","red","yellow")
col_2mgz=c("blue","cyan","green","orange","orange","green","cyan","green","orange","orange")
col_2yh1=c("green","orange","orange","red","orange","orange")
col_3nnh=c("cyan","green","yellow","green","cyan","cyan","green","orange")
col_4bs2=c("blue","cyan","green","yellow","green","green","orange","orange")

colors=c(col_1b7f,"white",col_1cvj,"white",col_2mgz,"white",col_2yh1,"white",col_3nnh,"white",col_4bs2,"white")

#inf2_2mgz=c(inf2_2mgz,0)
#inf3_2mgz=c(inf3_2mgz,0)
#inf5_2mgz=c(inf5_2mgz,0)
#min_2mgz=c(min_2mgz,0)
#Nb_2mgz=c(Nb_2mgz,0)

Nb=c(Nb_1b7f,c(0),Nb_1cvj,c(0),Nb_2mgz,c(0),Nb_2yh1,c(0),Nb_3nnh,c(0),Nb_4bs2,c(0))
inf2=c(inf2_1b7f,c(0),inf2_1cvj,c(0),inf2_2mgz,c(0),inf2_2yh1,c(0),inf2_3nnh,c(0),inf2_4bs2,c(0))
inf3=c(inf3_1b7f,c(0),inf3_1cvj,c(0),inf3_2mgz,c(0),inf3_2yh1,c(0),inf3_3nnh,c(0),inf3_4bs2,c(0))
inf4=c(inf4_1b7f,c(0),inf4_1cvj,c(0),inf4_2mgz,c(0),inf4_2yh1,c(0),inf4_3nnh,c(0),inf4_4bs2,c(0))
inf5=c(inf5_1b7f,c(0),inf5_1cvj,c(0),inf5_2mgz,c(0),inf5_2yh1,c(0),inf5_3nnh,c(0),inf5_4bs2,c(0))
m=c(min_1b7f,c(15),min_1cvj,c(15),min_2mgz,c(15),min_2yh1,c(15),min_3nnh,c(15),min_4bs2,c(15))

Nblog=log(Nb+1)
inf5log=log(inf5+1)
inf4log=log(inf4+1)
inf3log=log(inf3+1)
inf2log=log(inf2+1)

postscript("histochains2.eps",width=30,height=6)
barplot(Nblog, col=c(colors), ylim=c(0,8), axes=FALSE)
par(new=TRUE)
barplot(inf5log, col=1, angle=45, axes=FALSE, ylim=c(0,8), density=15)
par(new=TRUE)
barplot(inf2log, col=1, angle=-45, axes=FALSE, ylim=c(0,8), density=15)
par(new=TRUE)
plot(m,xlim=c(0.6,51.4), ylim=c(0,10), axes=FALSE,pch=21,bg="white",)
axis(4,at=c(0,1,2,3,4,5,6,7,8,9),pos=51.5,las=1,font=0.5,title="min RMSD (A)")
axis(2,at=c(0,log(2),log(11),log(101),log(1001), log(5001)),labels=c(0,1,10,100,1000,5000),pos=0,las=1,font=0.5)
dev.off()

ucolors=c(col_1b7f,"white",col_2yh1)
uNb=c(Nb_u1b7f,c(0),Nb_u2yh1)
uinf2=c(inf2_u1b7f,c(0),inf2_u2yh1)
uinf5=c(inf5_u1b7f,c(0),inf5_u2yh1)
um=c(min_u1b7f,c(15),min_u2yh1)

uNblog=log(uNb+1)
uinf5log=log(uinf5+1)
uinf2log=log(uinf2+1)

postscript("histochains2-unbound.eps",width=4,height=6)
barplot(uNblog, col=c(colors), ylim=c(0,8), axes=FALSE)
par(new=TRUE)
barplot(uinf5log, col=1, angle=45, axes=FALSE, ylim=c(0,8), density=10)
par(new=TRUE)
barplot(uinf2log, col=1, angle=-45, axes=FALSE, ylim=c(0,8), density=10)
par(new=TRUE)
plot(um,xlim=c(0.6,14.4), ylim=c(0,8), axes=FALSE,pch=21,bg="white",)
axis(4,at=c(0,1,2,3,4,5,6,7,8,9),pos=15,las=1,font=0.5)
axis(2,at=c(0,log(2),log(11),log(101),log(1001), log(5001)),labels=c(0,1,10,100,1000,5000),pos=0,las=1,font=0.5)
dev.off()


